
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quote Email Builder — The Compton</title>
  <meta name="description" content="Build templated client emails for Event, Rooms, or Event & Rooms quotes." />
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --card:#1f2937;
      --muted:#9ca3af;
      --text:#e5e7eb;
      --accent:#7c3aed;
      --accent-2:#22c55e;
      --danger:#ef4444;
      --border:#374151;
      --focus: #60a5fa;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      background:linear-gradient(120deg, #0b1021, #0f172a 40%, #0b1021 100%);
      color:var(--text);
      font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }
    .wrap{
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 16px 64px;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom: 20px;
    }
    h1{
      font-size: clamp(20px, 3vw, 28px);
      margin:0;
      letter-spacing:.3px;
    }
    .subtle{ color: var(--muted); font-size: 13px; }
    .grid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
    }
    @media (max-width: 960px){
      .grid{ grid-template-columns: 1fr; }
    }
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,.25);
    }
    .section-title{
      margin: 6px 0 12px;
      font-size: 15px;
      letter-spacing: .2px;
      color: #fff;
    }
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-bottom: 10px;
    }
    @media (max-width: 720px){
      .row{ grid-template-columns: 1fr; }
    }
    label{
      display:block;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    label .auto-badge {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      font-size: 9px;
      font-weight: 700;
      padding: 2px 5px;
      border-radius: 4px;
      margin-left: 6px;
      vertical-align: middle;
      letter-spacing: 0.5px;
    }
    input[type="text"], input[type="number"], input[type="date"], textarea, select{
      width: 100%;
      background: #0b1222;
      color: #e8ecf3;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 12px;
      outline: none;
      transition: border-color .15s, box-shadow .15s;
    }
    input::placeholder, textarea::placeholder { color: #6b7280; }
    input:focus, textarea:focus, select:focus{
      border-color: var(--focus);
      box-shadow: 0 0 0 3px rgba(96,165,250,.25);
    }
    input.auto-calc {
      background: #1a1a2e;
      border-color: var(--accent);
      color: #c4b5fd;
      cursor: not-allowed;
    }
    input.auto-calc:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(124,58,237,.25);
    }
    .muted-note{ color: var(--muted); font-size: 12px; margin-top: 8px; }
    .radio-group{
      display:flex; gap:14px; flex-wrap:wrap;
      background: #0b1222; padding:10px; border-radius:10px; border:1px solid var(--border);
    }
    .radio{
      display:flex; align-items:center; gap:8px; padding:6px 10px; border-radius:8px; cursor:pointer;
      border:1px dashed transparent;
    }
    .radio input{ accent-color: var(--accent); }
    .radio:hover{ border-color: var(--border); background: #0a1326; }
    .hidden{ display:none !important; }
    .btns{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
    button{
      background: var(--accent);
      color: white; border:0; padding:10px 14px; border-radius: 10px; cursor:pointer;
      font-weight: 600; letter-spacing:.2px;
      box-shadow: 0 6px 18px rgba(124,58,237,.35);
    }
    button.secondary{ background: #0b1222; border:1px solid var(--border); box-shadow:none; color:#e5e7eb; }
    button.success{ background: var(--accent-2); box-shadow: 0 6px 18px rgba(34,197,94,.30); }
    button.danger{ background: var(--danger); }
    textarea#preview{
      width:100%; min-height: 380px; resize: vertical; white-space: pre-wrap;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    .gate{
      position: fixed; inset: 0; display: grid; place-items:center;
      background: radial-gradient(1200px 600px at 25% -10%, rgba(124,58,237,.15), transparent),
                  radial-gradient(1200px 600px at 85% 110%, rgba(34,197,94,.12), transparent),
                  #0b1021;
      z-index: 1000;
    }
    .gate-card{
      width:min(520px, 92vw);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 22px;
      box-shadow: 0 24px 60px rgba(0,0,0,.45);
    }
    .gate h2{ margin:0 0 6px; font-size: 20px; }
    .error{ color: var(--danger); font-size: 13px; min-height: 1.2em; }
    .badge{
      display:inline-block; background:#14203d; color:#a5b4fc; border:1px solid #303d67;
      font-size:12px; padding:4px 8px; border-radius:999px; margin-top:6px;
    }
    .footer-note{ color:#94a3b8; font-size:12px; margin-top:16px; }
    .kicker{ font-size:12px; color:#9ca3af; margin:6px 0 14px; }
    .spacer{ height:8px; }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <noscript>
    <div class="wrap">
      <div class="card">
        <strong>JavaScript is required</strong> to use this tool.
      </div>
    </div>
  </noscript>

  <!-- Password Gate -->
  <div id="gate" class="gate" role="dialog" aria-modal="true" aria-labelledby="gate-title">
    <div class="gate-card">
      <h2 id="gate-title">Unlock Quote Builder</h2>
      <div class="kicker">Enter the 4‑digit access code to proceed.</div>

      <label for="pw">Access code</label>
      <input id="pw" type="password" inputmode="numeric" autocomplete="current-password" />

      <div id="pw-help" class="muted-note">Hint: Provided by Kelsey</div>
      <div class="spacer"></div>

      <div class="btns">
        <button id="unlockBtn" aria-label="Unlock">Unlock</button>
      </div>

      <div id="pw-error" class="error" aria-live="polite"></div>
      <div class="footer-note">Light client‑side gate for convenience only.</div>
    </div>
  </div>

  <div class="wrap" id="app" class="hidden" aria-live="polite" aria-busy="false" style="display:none">
    <header>
      <div>
        <h1>Quote Email Builder</h1>
        <div class="subtle">The Compton • Fill the fields → copy a clean email to send</div>
      </div>
      <div class="badge">v1.1</div>
    </header>

    <div class="grid">
      <!-- Left: Inputs -->
      <section class="card">
        <h3 class="section-title">1) Quote Type</h3>
        <div role="radiogroup" aria-label="Quote Type" class="radio-group">
          <label class="radio"><input type="radio" name="quoteType" value="event"> Event</label>
          <label class="radio"><input type="radio" name="quoteType" value="rooms"> Rooms</label>
          <label class="radio"><input type="radio" name="quoteType" value="both"> Event and Rooms</label>
        </div>
        <div class="muted-note">Choose one to reveal the relevant fields.</div>

        <h3 class="section-title" style="margin-top:18px;">2) Details</h3>

        <!-- Common fields -->
        <div id="commonFields" class="hidden" aria-hidden="true">
          <div class="row">
            <div>
              <label for="firstName">First name</label>
              <input id="firstName" type="text" placeholder="e.g., Alex" />
            </div>
            <div>
              <label for="lastName">Last name</label>
              <input id="lastName" type="text" placeholder="e.g., Rivera" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="groupName">Group name</label>
              <input id="groupName" type="text" placeholder="e.g., NWA Cycling Club" />
            </div>
            <div>
              <label for="arrivalDate">Arrival date</label>
              <input id="arrivalDate" type="date" />
            </div>
          </div>
        </div>

        <!-- Event fields -->
        <div id="eventFields" class="hidden" aria-hidden="true">
          <div class="row">
            <div>
              <label for="eventName">Event name</label>
              <input id="eventName" type="text" placeholder="e.g., Awards Dinner" />
            </div>
            <div>
              <label for="headcount">Headcount</label>
              <input id="headcount" type="number" inputmode="numeric" min="1" step="1" placeholder="e.g., 60" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="eventDay">Event day</label>
              <input id="eventDay" type="text" placeholder="e.g., Saturday" />
            </div>
            <div>
              <label for="eventDate">Event date</label>
              <input id="eventDate" type="date" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="eventTimeframe">Event timeframe</label>
              <input id="eventTimeframe" type="text" placeholder="e.g., 6:00–9:00 PM" />
            </div>
            <div>
              <label for="eventLocation">Event location</label>
              <input id="eventLocation" type="text" placeholder="e.g., The Conservatory" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="roomRental">Room rental ($)</label>
              <input id="roomRental" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 1000" />
            </div>
            <div>
              <label for="fbMinimum">F&amp;B Minimum ($)</label>
              <input id="fbMinimum" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 3500" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="eventSubtotal">Event subtotal <span class="auto-badge">AUTO</span></label>
              <input id="eventSubtotal" type="text" class="auto-calc" readonly tabindex="-1" placeholder="Auto-calculated" />
            </div>
            <div>
              <label for="eventTotal">Event total <span class="auto-badge">AUTO</span></label>
              <input id="eventTotal" type="text" class="auto-calc" readonly tabindex="-1" placeholder="Auto-calculated" />
            </div>
          </div>
        </div>

        <!-- Rooms fields -->
        <div id="roomsFields" class="hidden" aria-hidden="true">
          <div class="row">
            <div>
              <label for="peakRooms">Peak rooms</label>
              <input id="peakRooms" type="number" inputmode="numeric" min="1" step="1" placeholder="e.g., 20" />
            </div>
            <div>
              <label for="nights">Number of nights</label>
              <input id="nights" type="number" inputmode="numeric" min="1" step="1" placeholder="e.g., 2" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="departureDate">Departure date</label>
              <input id="departureDate" type="date" />
            </div>
            <div>
              <label for="nightlyRate">Nightly rate ($)</label>
              <input id="nightlyRate" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 209" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="subtotalRooms">Subtotal rooms <span class="auto-badge">AUTO</span></label>
              <input id="subtotalRooms" type="text" class="auto-calc" readonly tabindex="-1" placeholder="Auto-calculated" />
            </div>
            <div>
              <label for="roomTotal">Room total <span class="auto-badge">AUTO</span></label>
              <input id="roomTotal" type="text" class="auto-calc" readonly tabindex="-1" placeholder="Auto-calculated" />
            </div>
          </div>
        </div>

        <div class="btns">
          <button id="clearBtn" class="secondary" type="button">Clear all</button>
          <button id="copyBtn" class="success" type="button">Copy email</button>
        </div>
        <div class="muted-note">The email preview updates automatically as you type.</div>
      </section>

      <!-- Right: Preview -->
      <section class="card">
        <h3 class="section-title">3) Email Preview</h3>
        <textarea id="preview" aria-label="Email preview will appear here" spellcheck="false" placeholder="Select a Quote Type and start filling in fields..."></textarea>
        <div class="muted-note">
          Copy uses plain text with blank lines where you indicated "(paragraph spacing)".
        </div>
      </section>
    </div>
  </div>

  <script>
    // ------------------------
    // Password gate
    // ------------------------
    (function(){
      const gate = document.getElementById('gate');
      const app = document.getElementById('app');
      const pw = document.getElementById('pw');
      const unlockBtn = document.getElementById('unlockBtn');
      const err = document.getElementById('pw-error');

      const ACCESS = '4273';

      function unlock(){
        if (pw.value.trim() === ACCESS){
          sessionStorage.setItem('quote_builder_unlocked', '1');
          gate.style.display = 'none';
          app.style.display = '';
        } else {
          err.textContent = 'Incorrect code. Please try again.';
          pw.focus();
        }
      }

      if (sessionStorage.getItem('quote_builder_unlocked') === '1'){
        gate.style.display = 'none';
        app.style.display = '';
      }

      unlockBtn.addEventListener('click', unlock);
      pw.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ unlock(); } });
      setTimeout(()=>pw.focus(), 50);
    })();

    // ------------------------
    // Templates
    // ------------------------
    const TEMPLATE_EVENT = `Hey there, {{First name}}, (paragraph spacing) I received your request about hosting the {{Group name}} here at The Compton, and I'd love to explore what this could potentially look like. I'd love to understand more about your vision, so if any of the information I've provided sounds incorrect, please just let me know. (paragraph spacing) For {{Event name}} on {{Event day}}, {{Event date}} from approximately {{Event timeframe}} with an estimated headcount of {{Headcount}}, I would recommend hosting the group in {{Event location}}. I've attached some pictures of {{Event location}} to this email for reference. For a {{Event timeframe}} block on a {{Event day}}, {{Event location}} has two prices associated with reserving: a room rental fee and a required food and beverage minimum spend. For this specific request, the room rental for {{Event location}} is {{Room rental}} and the F&B minimum is {{F&B minimum}}, totaling to a combined {{Event subtotal}}. Both costs are subject to applicable taxes and service fees, which would bring the total cost for your event to {{Event total}}. I just want to be transparent and make sure you know what to expect in-full for your event with us. (Paragraph spacing) I would love to know your initial thoughts, as well as answer any questions you have. If there are any details I've left out or stated incorrectly, please just let me know. I look forward to hopefully hosting {{Group name}} at The Compton on {{Event date}}! (paragraph spacing) Your friend at The Compton, (paragraph spacing) Kelsey (paragraph spacing)`;

    const TEMPLATE_ROOMS = `Hey there, {{First name}}, (paragraph spacing) I received your request about hosting the {{Group name}} here at The Compton, and I'd love to explore what this could potentially look like. I'd love to understand more about your vision, so if any of the information I've provided sounds incorrect, please just let me know. (paragraph spacing) As I understand it, you're interested in a group room block of {{Peak rooms}} rooms over the span of {{Number of nights}} night(s), with a check-in date of {{Arrival date}} and a check-out on {{Departure date}}. For this request, I can approve a nightly rate of {{Nightly rate}} for one of our single occupancy rooms before tax. That would be a subtotal of {{Subtotal rooms}}, and approximately {{Room total}} after all applicable taxes and fees. (paragraph spacing) I would love to know your initial thoughts, as well as answer any questions you have. If there are any details I've left out or stated incorrectly, please just let me know. I look forward to hopefully hosting {{Group name}} at The Compton on {{Arrival date}}!`;

    const TEMPLATE_BOTH = `Hey there, {{First name}}, (paragraph spacing) I received your request about hosting the {{Group name}} here at The Compton, and I'd love to explore what this could potentially look like. I'd love to understand more about your vision, so if any of the information I've provided sounds incorrect, please just let me know. (paragraph spacing) As I understand it, you're interested in a group room block of {{Peak rooms}} rooms over the span of {{Number of nights}} night(s), with a check-in date of {{Arrival date}} and a check-out on {{Departure date}}. For this request, I can approve a nightly rate of {{Nightly rate}} for one of our single occupancy rooms before tax. That would be a subtotal of {{Subtotal rooms}}, and approximately {{Room total}} after all applicable taxes and fees. (paragraph spacing)  As for {{Event name}} on {{Event day}}, {{Event date}} from approximately {{Event timeframe}} with an estimated headcount of {{Headcount}}, I would recommend hosting the group in {{Event location}}. I've attached some pictures of {{Event location}} to this email for reference. For a {{Event timeframe}} block on a {{Event day}}, {{Event location}} has two prices associated with reserving: a room rental fee and a required food and beverage minimum spend. For this specific request, the room rental for {{Event location}} is {{Room rental}} and the F&B minimum is {{F&B minimum}}, totaling to a combined {{Event subtotal}}. Both costs are subject to applicable taxes and service fees, which would bring the total cost for your event to {{Event total}}. I just want to be transparent and make sure you know what to expect in-full for your event with us. (paragraph spacing)  I would love to know your initial thoughts, as well as answer any questions you have. If there are any details I've left out or stated incorrectly, please just let me know. I look forward to hopefully hosting {{Group name}} at The Compton on {{Event date}}! (paragraph spacing) Your friend at The Compton, (paragraph spacing) Kelsey (paragraph spacing)`;

    // ------------------------
    // Utilities
    // ------------------------
    function $(id){ return document.getElementById(id); }
    function escapeRegExp(str){ return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }
    function fmtDateInputToLong(dateInputValue){
      if(!dateInputValue) return '';
      const d = new Date(dateInputValue + 'T00:00:00');
      if (isNaN(d)) return '';
      return d.toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });
    }
    function fmtCurrency(num){
      if (num === null || num === undefined || isNaN(num)) return '';
      return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    // ------------------------
    // Tax Calculation Functions
    // ------------------------
    
    // Room Rental: 2% A&P + 23% service fee + 9.5% tax on service fee
    function calcRoomRentalTotal(rental) {
      if (!rental || rental <= 0) return 0;
      const apTax = rental * 0.02;
      const serviceFee = rental * 0.23;
      const taxOnService = serviceFee * 0.095;
      return rental + apTax + serviceFee + taxOnService;
    }

    // F&B: 10.5% sales tax + 23% service fee + 9.5% tax on service fee
    function calcFBTotal(fb) {
      if (!fb || fb <= 0) return 0;
      const salesTax = fb * 0.105;
      const serviceFee = fb * 0.23;
      const taxOnService = serviceFee * 0.095;
      return fb + salesTax + serviceFee + taxOnService;
    }

    // Hotel Rooms: 13.5% room tax
    function calcRoomBlockTotal(subtotal) {
      if (!subtotal || subtotal <= 0) return 0;
      return subtotal * 1.135;
    }

    // ------------------------
    // Auto-calculation
    // ------------------------
    function updateCalculations() {
      // Event calculations
      const roomRental = parseFloat($('roomRental').value) || 0;
      const fbMinimum = parseFloat($('fbMinimum').value) || 0;
      
      const eventSubtotal = roomRental + fbMinimum;
      const eventTotal = calcRoomRentalTotal(roomRental) + calcFBTotal(fbMinimum);
      
      $('eventSubtotal').value = eventSubtotal > 0 ? fmtCurrency(eventSubtotal) : '';
      $('eventTotal').value = eventTotal > 0 ? fmtCurrency(eventTotal) : '';

      // Rooms calculations
      const peakRooms = parseInt($('peakRooms').value) || 0;
      const nights = parseInt($('nights').value) || 0;
      const nightlyRate = parseFloat($('nightlyRate').value) || 0;
      
      const roomsSubtotal = peakRooms * nights * nightlyRate;
      const roomsTotal = calcRoomBlockTotal(roomsSubtotal);
      
      $('subtotalRooms').value = roomsSubtotal > 0 ? fmtCurrency(roomsSubtotal) : '';
      $('roomTotal').value = roomsTotal > 0 ? fmtCurrency(roomsTotal) : '';
    }

    // ------------------------
    // Field visibility toggling
    // ------------------------
    const radios = Array.from(document.querySelectorAll('input[name="quoteType"]'));
    const commonFields = $('commonFields');
    const eventFields = $('eventFields');
    const roomsFields = $('roomsFields');

    radios.forEach(r => r.addEventListener('change', () => {
      const v = radios.find(x=>x.checked)?.value;
      const showCommon = !!v;
      commonFields.classList.toggle('hidden', !showCommon);
      commonFields.setAttribute('aria-hidden', String(!showCommon));

      const showEvent = (v === 'event' || v === 'both');
      eventFields.classList.toggle('hidden', !showEvent);
      eventFields.setAttribute('aria-hidden', String(!showEvent));

      const showRooms = (v === 'rooms' || v === 'both');
      roomsFields.classList.toggle('hidden', !showRooms);
      roomsFields.setAttribute('aria-hidden', String(!showRooms));

      updateCalculations();
      updatePreview();
    }));

    // ------------------------
    // Live preview generation
    // ------------------------
    const inputs = [
      'firstName','lastName','groupName','arrivalDate',
      'eventName','headcount','eventDay','eventDate','eventTimeframe','eventLocation','roomRental','fbMinimum',
      'peakRooms','nights','departureDate','nightlyRate'
    ].map($);

    inputs.forEach(el => {
      if (!el) return;
      el.addEventListener('input', () => {
        updateCalculations();
        updatePreview();
      });
      if (el.type === 'date') el.addEventListener('change', () => {
        updateCalculations();
        updatePreview();
      });
      if (el.type === 'number') el.addEventListener('change', () => {
        updateCalculations();
        updatePreview();
      });
    });

    function getCurrentTemplate(){
      const v = radios.find(x=>x.checked)?.value;
      if (v === 'event') return TEMPLATE_EVENT;
      if (v === 'rooms') return TEMPLATE_ROOMS;
      if (v === 'both') return TEMPLATE_BOTH;
      return '';
    }

    function updatePreview(){
      let tpl = getCurrentTemplate();
      if (!tpl){
        $('preview').value = '';
        return;
      }

      // Get raw number values for currency formatting in preview
      const roomRental = parseFloat($('roomRental').value) || 0;
      const fbMinimum = parseFloat($('fbMinimum').value) || 0;
      const nightlyRate = parseFloat($('nightlyRate').value) || 0;

      const values = {
        'First name': $('firstName').value || '',
        'Last name': $('lastName').value || '',
        'Group name': $('groupName').value || '',
        'Arrival date': fmtDateInputToLong($('arrivalDate').value),

        'Event name': $('eventName').value || '',
        'Headcount': $('headcount').value || '',
        'Event day': $('eventDay').value || '',
        'Event date': fmtDateInputToLong($('eventDate').value),
        'Event timeframe': $('eventTimeframe').value || '',
        'Event location': $('eventLocation').value || '',
        'Room rental': roomRental > 0 ? fmtCurrency(roomRental) : '',
        'F&B minimum': fbMinimum > 0 ? fmtCurrency(fbMinimum) : '',
        'Event subtotal': $('eventSubtotal').value || '',
        'Event total': $('eventTotal').value || '',

        'Peak rooms': $('peakRooms').value || '',
        'Number of nights': $('nights').value || '',
        'Departure date': fmtDateInputToLong($('departureDate').value),
        'Nightly rate': nightlyRate > 0 ? fmtCurrency(nightlyRate) : '',
        'Subtotal rooms': $('subtotalRooms').value || '',
        'Room total': $('roomTotal').value || ''
      };

      for (const [key, val] of Object.entries(values)){
        const re = new RegExp('{{\\s*' + escapeRegExp(key) + '\\s*}}', 'g');
        tpl = tpl.replace(re, val || '{{' + key + '}}');
      }

      tpl = tpl.replace(/\(paragraph spacing\)/gi, '\n\n');
      tpl = tpl.replace(/[ \t]{2,}/g, ' ');

      $('preview').value = tpl.trim();
    }

    // ------------------------
    // Copy & Clear
    // ------------------------
    $('copyBtn').addEventListener('click', async () => {
      const txt = $('preview').value;
      if (!txt){
        alert('Nothing to copy yet. Please select a Quote Type and fill in fields.');
        return;
      }
      try{
        await navigator.clipboard.writeText(txt);
        const btn = $('copyBtn');
        const prev = btn.textContent;
        btn.textContent = 'Copied!';
        btn.disabled = true;
        setTimeout(()=>{ btn.textContent = prev; btn.disabled = false; }, 1100);
      } catch (e){
        $('preview').select();
        document.execCommand('copy');
      }
    });

    $('clearBtn').addEventListener('click', () => {
      document.querySelectorAll('input[type="text"], input[type="number"], input[type="date"]').forEach(el => {
        if (!el.classList.contains('auto-calc')) {
          el.value = '';
        }
      });
      document.querySelectorAll('input[name="quoteType"]').forEach(el => el.checked = false);
      $('eventSubtotal').value = '';
      $('eventTotal').value = '';
      $('subtotalRooms').value = '';
      $('roomTotal').value = '';
      commonFields.classList.add('hidden'); commonFields.setAttribute('aria-hidden','true');
      eventFields.classList.add('hidden'); eventFields.setAttribute('aria-hidden','true');
      roomsFields.classList.add('hidden'); roomsFields.setAttribute('aria-hidden','true');
      $('preview').value = '';
    });

    updatePreview();
  </script>
</body>
</html>
